import{C as c,D as h,E as r,q as i,ad as d,F as p,ac as m,G as y,ae as C,J as w,af as S,ag as V}from"./index-a11206d4.js";import{_ as z,X as k,Y as u,$ as f,E as g,a0 as U,I as _,a1 as q}from"./VSheet-1b2bd39d.js";const T={name:"googleSheet",watch:{sheetUrl(e){e!==""&&console.log(e)}},data:()=>({sheetUrl:"",sheetName:"",wordList:[],currentQuestion:null,currentQuestionKor:null,placeholder:"",answer:"",hint:"",quizType:["주관식","객관식"],selectedQuizType:"주관식"}),mounted(){},methods:{sheetUrlCheck(){if(this.sheetUrl===""){this.$swal.fire({text:"URL을 입력해 주세요.",showConfirmButton:!1,timer:1e3,icon:"warning"});return}const t=this.sheetUrl.trim().match(/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);if(t&&t[1]){const s="https://docs.google.com/spreadsheets/d/"+t[1]+"/gviz/tq?tqx=out:json&tq&sheet="+encodeURIComponent(this.sheetName);this.createWordList(s)}else this.$swal.fire({text:"잘못된 URL입니다.",showConfirmButton:!1,timer:1e3,icon:"warning"})},async getQuizData(e){const n=await(await fetch(e)).text();return s(n.substring(47).slice(0,-2));function s(o){return JSON.parse(o).table.rows}},createWordList(e){this.getQuizData(e).then(t=>{let n=[];for(let s=0;s<t.length;s++){let o={date:t[s].c[0].v,index:t[s].c[1].v,eng:t[s].c[2].v,kor:t[s].c[3].v,part:t[s].c[4].v,level:t[s].c[5].v};n.push(o)}this.wordList=n,this.createQuiz()}).catch(t=>{console.error("Error fetching quiz data:",t)})},async createQuiz(){this.currentQuestion=this.wordList[Math.floor(Math.random()*this.wordList.length)],await this.displayQuestion(this.currentQuestion)},async displayQuestion(e){this.currentQuestionKor=e.kor,this.currentQuestion=e,await this.updateHint(),await this.updatePlaceholder(),this.$refs.answer.focus()},updateHint(){this.currentQuestion.eng.includes(" ")?this.updateHintWithSpace():this.updateHintWithoutSpace()},updateHintWithSpace(){let e="";for(let t=0;t<this.currentQuestion.eng.length;t++){if(t===0){e+=this.currentQuestion.eng[t];continue}this.currentQuestion.eng[t]===" "?e+="&nbsp;&nbsp;":this.isSpecialCharacter(this.currentQuestion.eng[t])?e+=this.currentQuestion.eng[t]:t===this.currentQuestion.eng.length-1?e+=this.currentQuestion.eng[t]:e+="_ "}this.hint=e,this.hint+=` (공백 포함 ${this.currentQuestion.eng.length}글자)`},updateHintWithoutSpace(){if(this.currentQuestion.eng.length===1)this.hint="_";else if(this.currentQuestion.eng.length>3){let e=this.currentQuestion.eng[0];for(let t=1;t<this.currentQuestion.eng.length-1;t++)e+=this.isSpecialCharacter(this.currentQuestion.eng[t])?this.currentQuestion.eng[t]:"_ ";e+=this.currentQuestion.eng[this.currentQuestion.eng.length-1],this.hint=e}else this.hint=this.currentQuestion.eng[0]+" _ ".repeat(this.currentQuestion.eng.length-1);this.hint+=` (${this.currentQuestion.eng.replace(/ /g,"").length}글자)`},isSpecialCharacter(e){return/[!@#$*~]/.test(e)},updatePlaceholder(){this.placeholder="_ ".repeat(this.currentQuestion.eng.length-1)+"_"},calculateFontSize(e){if(e===""||e===null||e===void 0)return!1;const t=6,n=3,s=e.length;if(s>t){const o=t/s;return`${n*o}rem`}return`${n}rem`},isViewHint(){this.showHint()},showHint(){this.$swal.fire({title:"힌트",html:`<p>${this.hint}</p>`,confirmButtonText:"닫기",icon:"question"}).then(e=>{e.isConfirmed&&setTimeout(()=>{this.$refs.answer.focus()},300)})},checkAnswer(){this.$refs.answer.blur();const e=this.answer.toLowerCase(),t=this.currentQuestion.eng.toLowerCase(),n=e===t,s={index:this.$store.state.answerHistory.length+1,questionObj:this.currentQuestion,question:this.currentQuestion.kor,questionType:"구글 시트",isCorrect:n,correctAnswer:this.currentQuestion.eng,userAnswer:e};this.$store.commit("addToAnswerHistory",s),n?this.$swal.fire({title:"정답입니다!",showConfirmButton:!1,timer:1e3,icon:"success"}):this.$swal.fire({title:"틀렸습니다.",text:"정답 : "+this.currentQuestion.eng,confirmButtonText:"닫기",focusDeny:!0,didOpen:()=>{document.querySelector(".swal2-confirm").focus()},icon:"error"}).then(o=>{o.isConfirmed&&setTimeout(()=>{this.$refs.answer.focus()},300)}),this.answer="",this.createQuiz()}}},Q=e=>(S("data-v-a255b8de"),e=e(),V(),e),b=Q(()=>m("p",{style:{textAlign:"left",marginBottom:"10px"}},"구글 스프레드 시트의 URL을 입력해 주세요.",-1)),v=Q(()=>m("p",{style:{textAlign:"left",marginBottom:"10px"}},"구글 스프레드 시트 하단의 '시트 이름'을 입력해 주세요.",-1));function $(e,t,n,s,o,l){return c(),h(k,{class:"fill-height"},{default:r(()=>[i(q,{class:"align-center text-center fill-height"},{default:r(()=>[e.wordList.length===0?(c(),h(u,{key:0},{default:r(()=>[b,i(f,{label:"시트 주소",modelValue:e.sheetUrl,"onUpdate:modelValue":t[0]||(t[0]=a=>e.sheetUrl=a),type:"url",onKeyup:d(l.sheetUrlCheck,["enter"]),placeholder:"https://docs.google.com/spreadsheets/d/q1w2e3r4-t56y7u8i9o-0p/edit#gid=0",required:""},null,8,["modelValue","onKeyup"]),v,i(f,{label:"시트 이름",modelValue:e.sheetName,"onUpdate:modelValue":t[1]||(t[1]=a=>e.sheetName=a),type:"text",placeholder:"시트1",onKeyup:d(l.sheetUrlCheck,["enter"]),required:""},null,8,["modelValue","onKeyup"]),i(g,{class:"btn",onClick:l.sheetUrlCheck,color:"mainColor"},{default:r(()=>[p("퀴즈 생성")]),_:1},8,["onClick"])]),_:1})):(c(),h(u,{key:1},{default:r(()=>[i(U),i(u,null,{default:r(()=>[i(_,{modelValue:e.selectedQuizType,"onUpdate:modelValue":t[2]||(t[2]=a=>e.selectedQuizType=a),id:"selectedQuizType",name:"selectedQuizType",ref:"selectedQuizType",items:e.quizType,label:"문제 타입",dense:"",outlined:"","hide-details":"",color:"fontColor"},null,8,["modelValue","items"])]),_:1}),e.selectedQuizType==="주관식"?(c(),h(u,{key:0},{default:r(()=>[i(u,{class:"questionWrapper"},{default:r(()=>[m("p",{class:"questionStyle",ref:"question",style:C({fontSize:l.calculateFontSize(e.currentQuestionKor)})},y(e.currentQuestionKor),5)]),_:1}),i(f,{ref:"answer",modelValue:e.answer,"onUpdate:modelValue":t[3]||(t[3]=a=>e.answer=a),placeholder:e.placeholder,dense:"",variant:"outlined","hide-details":"",onKeyup:d(l.checkAnswer,["enter"]),color:"fontColor",class:"custom-input-field"},null,8,["modelValue","placeholder","onKeyup"]),i(u,{class:"btnWrapper"},{default:r(()=>[i(g,{class:"btn mgr",onClick:l.isViewHint,color:"mainColor"},{default:r(()=>[p("힌트")]),_:1},8,["onClick"]),i(g,{class:"btn",onClick:t[4]||(t[4]=a=>l.checkAnswer()),color:"mainColor"},{default:r(()=>[p("확인")]),_:1})]),_:1})]),_:1})):w("",!0),e.selectedQuizType==="객관식"?(c(),h(u,{key:1})):w("",!0)]),_:1}))]),_:1})]),_:1})}const A=z(T,[["render",$],["__scopeId","data-v-a255b8de"]]);export{A as default};
